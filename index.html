<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>대지면적·용적률 설계개요 계산기</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 480px;
      margin: 0 auto;
      padding: 16px;
      box-sizing: border-box;
    }
    h1 {
      font-size: 20px;
      margin-bottom: 16px;
    }
    label {
      display: block;
      margin-top: 12px;
      font-size: 14px;
    }
    select, input {
      width: 100%;
      padding: 8px;
      margin-top: 4px;
      box-sizing: border-box;
      font-size: 14px;
    }
    button {
      margin-top: 16px;
      width: 100%;
      padding: 10px;
      font-size: 16px;
      cursor: pointer;
    }
    .result {
      margin-top: 20px;
      padding: 12px;
      border: 1px solid #ddd;
      border-radius: 8px;
      font-size: 14px;
      white-space: pre-line;
    }
    .note {
      margin-top: 8px;
      font-size: 12px;
      color: #666;
    }
  </style>
</head>
<body>
  <h1>설계개요 계산기 (84타입 기준)</h1>

  <!-- 1. 대분류 선택 -->
  <label>
    대분류
    <select id="category">
      <option value="over800">800세대 이상</option>
      <option value="500to800">500~800세대</option>
      <option value="under500">500세대 미만</option>
      <option value="mixedUse">주상복합</option>
    </select>
  </label>

  <!-- 2. 기본 입력값 -->
  <label>
    대지면적 (㎡)
    <input id="siteArea" type="number" placeholder="예: 30000" />
  </label>

  <label>
    건폐율(법정) (%)
    <input id="bcr" type="number" placeholder="예: 20" />
  </label>

  <label>
    용적률(법정) (%)
    <input id="far" type="number" placeholder="예: 250" />
  </label>

  <label>
    세대당 주차대수 (대/세대)
    <input id="parkingPerUnit" type="number" step="0.1" placeholder="예: 1.3" value="1.3" />
  </label>

  <div class="note">
    ※ 84타입 기준 1세대당 지상연면적 112㎡ 가정.<br>
    - 44타입, 59타입, 74타입 복합구성은 추후 개발. <br>
    - 주상복합: 고려할 사항 너무많음. 현재 계산 미지원 (개발 진행중)
  </div>

  <button id="calcBtn">계산하기</button>

  <div id="result" class="result"></div>

  <script>
    // 카테고리별 가정값
    const CATEGORY_CONFIG = {
      over800: {           // 800세대 이상
        abovePerUnit: 112,
        extraAboveFacility: 0,   // 고정 지상복리 없음
        facilityPerUnitB1: 4.1,
        parkingPerCarB1: 35.6,
      },
      "500to800": {        // 500~800세대
        abovePerUnit: 112,
        extraAboveFacility: 0,
        facilityPerUnitB1: 3.8,
        parkingPerCarB1: 37.0,
      },
      under500: {          // 500세대 미만
        abovePerUnit: 112,
        extraAboveFacility: 800,  // 단지당 지상 복리시설 800㎡
        facilityPerUnitB1: 3.5,
        parkingPerCarB1: 39.5,
      },
      mixedUse: {          // 주상복합: 현재 계산 미사용 (placeholder)
        abovePerUnit: 112,
        extraAboveFacility: 0,
        facilityPerUnitB1: 4.1,
        parkingPerCarB1: 35.6,
      },
    };

    function formatNumber(x, digits = 1) {
      const m = Math.pow(10, digits);
      return Math.round(x * m) / m;
    }

    function getCategoryLabel(value) {
      switch (value) {
        case "over800":  return "800세대 이상";
        case "500to800": return "500~800세대";
        case "under500": return "500세대 미만";
        case "mixedUse": return "주상복합";
        default:         return "";
      }
    }

    function calculateSummary(input) {
      const { siteArea, far, parkingPerUnit, category } = input;

      const cfg = CATEGORY_CONFIG[category] || CATEGORY_CONFIG["over800"];
      const ABOVE_PER_UNIT        = cfg.abovePerUnit;
      const EXTRA_ABOVE_FAC       = cfg.extraAboveFacility;   // 단지당 지상 복리시설
      const FACILITY_PER_UNIT_B1  = cfg.facilityPerUnitB1;    // 지하 시설/세대
      const PARKING_PER_CAR_B1    = cfg.parkingPerCarB1;      // 지하 주차장/대

      // 1) 용적률 한도 내 이론상 지상연면적
      const gfaLimitAbove = siteArea * (far / 100); // ㎡

      // 2) 지상 복리시설 (under500만 800㎡, 나머지는 0) 선점
      let gfaForUnits = gfaLimitAbove - EXTRA_ABOVE_FAC;
      if (gfaForUnits < 0) gfaForUnits = 0;

      // 3) 세대수: (세대당 112㎡) 기준, 내림
      const units = Math.floor(gfaForUnits / ABOVE_PER_UNIT);

      // 4) 실제 지상연면적 = 세대수 × 112 + 지상 복리시설
      const gfaAbove = units * ABOVE_PER_UNIT + EXTRA_ABOVE_FAC;

      // 5) 지상부 실제 용적률
      const farActual = (gfaAbove / siteArea) * 100;

      // 6) 지하 시설연면적
      const gfaB1Facility = units * FACILITY_PER_UNIT_B1;

      // 7) 총 주차대수
      const totalParking = Math.ceil(units * parkingPerUnit);

      // 8) 지하 주차장 연면적
      const gfaB1Parking = totalParking * PARKING_PER_CAR_B1;

      // 9) 지하 연면적 총합
      const gfaBelow = gfaB1Facility + gfaB1Parking;

      // 10) 전체 연면적
      const gfaTotal = gfaAbove + gfaBelow;

      return {
        units,
        gfaAbove,
        gfaBelow,
        gfaTotal,
        farActual,
        totalParking,
        cfg,
      };
    }

    function onClickCalculate() {
      const category       = document.getElementById("category").value;
      const siteArea       = parseFloat(document.getElementById("siteArea").value);
      const bcr            = parseFloat(document.getElementById("bcr").value); // 아직 층수 계산에는 미사용
      const far            = parseFloat(document.getElementById("far").value);
      const parkingPerUnit = parseFloat(document.getElementById("parkingPerUnit").value);
      const resultDiv      = document.getElementById("result");

      // 주상복합은 아직 계산 안 함
      if (category === "mixedUse") {
        const catLabel = getCategoryLabel(category);
        resultDiv.textContent =
`▶ 대분류
- ${catLabel}

현재 주상복합 카테고리는 개발 진행중입니다.
(향후 상가/업무/주거 비율 및 주차 분리 기준을 반영한 별도 계산 로직이 추가될 예정입니다.)`;
        return;
      }

      if ([siteArea, far, parkingPerUnit].some(v => isNaN(v))) {
        resultDiv.textContent = "대지면적, 용적률, 세대당 주차대수를 숫자로 입력해주세요.";
        return;
      }

      const summary  = calculateSummary({ siteArea, far, parkingPerUnit, category });
      const catLabel = getCategoryLabel(category);

      const text =
`▶ 산정 결과 (84타입 기준)
- 지상연면적: 약 ${formatNumber(summary.gfaAbove, 1)} ㎡
- 지하연면적: 약 ${formatNumber(summary.gfaBelow, 1)} ㎡
- 전체연면적: 약 ${formatNumber(summary.gfaTotal, 1)} ㎡
- 지상부 실제 용적률: 약 ${formatNumber(summary.farActual, 2)} %
- 84타입 기준 세대수: 약 ${summary.units} 세대
- 총 주차대수: 약 ${summary.totalParking} 대

[카테고리별 가정값]
- 1세대당 지상연면적: ${summary.cfg.abovePerUnit} ㎡/세대
- 단지당 지상 복리시설: ${summary.cfg.extraAboveFacility} ㎡
- 지하 시설연면적: ${summary.cfg.facilityPerUnitB1} ㎡/세대
- 지하 주차장 면적: ${summary.cfg.parkingPerCarB1} ㎡/대

※ 지구단위계획, 조례, 평형 구성에 따라 실제 값은 달라질 수 있습니다.`;

      resultDiv.textContent = text;
    }

    document.addEventListener("DOMContentLoaded", function () {
      document.getElementById("calcBtn").addEventListener("click", onClickCalculate);
    });
  </script>
</body>
</html>

